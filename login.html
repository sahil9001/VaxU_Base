<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"
    />
    <link rel="stylesheet" href="styles/styles.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>
  </head>
  <body>

    <!--[if lt IE 7]>
      <p class="browsehappy">
        You are using an <strong>outdated</strong> browser. Please
        <a href="#">upgrade your browser</a> to improve your experience.
      </p>
    <![endif]-->
    <nav
      class="navbar is-fixed-top signal-navbar"
      role="navigation"
      aria-label="main navigation"
    >
      <div class="container">
        <div class="navbar-brand">
          <a href="">
            <img class="signal-logo" src="assets/logo/VaxU_Logo.png" />
          </a>
          <a
            role="button"
            class="navbar-burger"
            aria-label="menu"
            aria-expanded="false"
            data-target="navbarBasicExample"
          >
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>

        <div id="navbarBasicExample" class="navbar-menu">
          <div class="navbar-end">
            <a class="navbar-item"> Home </a>
            <a class="navbar-item" href="#whyus"> Why VaxU? </a>
            <a class="navbar-item"> Home </a>

            <a class="navbar-item"> Get VaxU </a>

            <div class="navbar-item">
              <div class="buttons">
                <a class="button is-light"> Log in </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <!--<section class="first-three">
      <div class="container">
        <div class="field">
          <label class="label">Username</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input is-success" type="email" placeholder="Text input" id="username">
                <span class="icon is-small is-left">
                  <i class="fas fa-user"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-check"></i>
                </span>
              </div>
          <p class="help is-success">This username is available</p>
        </div>
        <div class="field">
          <label class="label">Password</label>
          <div class="control has-icons-left has-icons-right">
            <input class="input is-danger" type="password" placeholder="Password input" id="password">
            <span class="icon is-small is-left">
              <i class="fas fa-password"></i>
            </span>
            <span class="icon is-small is-right">
              <i class="fas fa-exclamation-triangle"></i>
            </span>
          </div>
          <p class="help is-danger">This password is invalid</p>
        </div>
        <div class="buttons is-centered">
              <button class="button is-success is-medium" onclick="trylogin()">Submit!</button>
        </div>
        </div>
      </section>-->
      <div class="hero is-fullheight is-primary">
          <div class="hero-body">
              <div class="container has-text-centered">
                  <div class="column is-8 is-offset-2">
                      <h3 class="title has-text-white">Login</h3>
                      <hr class="login-hr">
                      <p class="subtitle has-text-white">Please login to continue</p>
                      <div class="box">
                          <img src="assets/logo/VaxU_Logo.png">
                      </div>
                      <div class="title has-text-grey is-5">Enter your email and password below</div>
                      <form>
                          <div class="field">
                              <div class="control has-icons-left has-icons-right">
                                  <input class="input is-medium" type="email" placeholder="Email" autofocus="" id="username">
                              </div>
                          </div>
                          <div class="field">
                              <div class="control has-icons-left has-icons-right">
                                  <input class="input is-medium" type="password" placeholder="Password" id="password">
                                  <span class="icon is-small is-left">
                                      <i class="fas fa-password"></i>
                                  </span>
                              </div>
                          </div>
                      </form>
                      <label class="checkbox" style="margin: 20px;">
                          <input type="checkbox">
                          Remember Me
                      </label>
                      <button class="button is-block is-danger is-large is-fullwidth" onclick="trylogin()">Login</button>
                  </div>
              </div>
          </div>
      </div>
    <!--<footer class="footer">
      <div class="container">
        <div class="columns">
          <div class="column is-two-fifths is-hidden-mobile">
            <span class="copyright"> Made by Team --- </span>
          </div>
        </div>
      </div>
    </footer>-->
    <script>
        var host = "sahil9001.github.io/VaxU_Base/";
       function trylogin(){
            var _token;
            var userName = document.getElementById('username').value;
            var password = document.getElementById('password').value;
            var urlToHit = "http://20.198.3.123:80/api/users/vacc/login/";
            var request = new XMLHttpRequest();

            function getToken(urlToHit, email, password){
                var key;
                request.open("POST", urlToHit, true);
                request.setRequestHeader("Content-type", "application/json");
                request.onreadystatechange = function() {
                    if(request.readyState == 4 && request.status == 202){
                        var response = request.responseText;
                        var obj = JSON.parse(response);
                        console.log(obj);
                        key = obj.token;
                        localStorage.setItem(email, key);
                        console.log('token is : ' + key);
                        success(userName);
                    }
                }
                var data = {
                    "email"  : email,
                    "password" : password
                };
                console.log(data);
                request.send(JSON.stringify(data));
                console.log(request.status);
                console.log('Hi');
                
            }
            //request.withCredentials = true;
            getToken(urlToHit, userName, password);
        }
        function success(userName){
            //curr_url = location.href;
            var name = "username=" + userName;
            document.cookie = name;
            location.href = "http://" + host + "dashboard.html";
        }
        </script>
   <!-- <script language="JavaScript" type="text/javascript" src="styles/app.js"></script>-->
  </body>
</html>
